#! /bin/bash --login
#SBATCH -p himem 
#SBATCH -t 2-0
#SBATCH -n 2

#SBATCH --mail-user=michael.haley@manchester.ac.uk
#SBATCH --mail-type=ALL

#@DESC: Produces visualisations for populations
#@IN:   anndata_processed.h5ad, masks, processed
#@OUT:  QC/BasicProcess_QC

echo "Visualisations job is using $SLURM_GPUS GPU(s) with ID(s) $CUDA_VISIBLE_DEVICES and $SLURM_NTASKS CPU core(s)"

module load gcc/13.3.0
export MPLBACKEND="Agg"
export QT_QPA_PLATFORM="offscreen"
unset DISPLAY
export OPENAI_API_KEY="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"

conda activate segmentation

python -m SpatialBiologyToolkit.scripts.basic_visualizations